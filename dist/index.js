!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-dom"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).main={},e.React,e.ReactDOM)}(this,(function(e,t,n){"use strict";function r(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var a,l=r(t);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}var s=n;a=s.createRoot,s.hydrateRoot;class u{constructor(){this.startOfMerge=!1,this.inMerge=!1}}function i(e){let t={numrows:e.length,numcols:0};for(let n=0;n<t.numrows;n++){let r=e[n]?.values?.length;r&&r>t.numcols&&(t.numcols=r)}return t}function c(e){if(null==e)return"";return`rgb(${e.red?255*e.red:0}, ${e.green?255*e.green:0}, ${e.blue?255*e.blue:0})`}function d(e){let t={};return e?(null!=e.foregroundColorStyle?.rgbColor&&(t.color=c(e.foregroundColorStyle.rgbColor)),null!=e.fontFamily&&(t.fontFamily=e.fontFamily),null!=e.fontSize&&(t.fontSize=`${e.fontSize}pt`),null!=e.bold&&e.bold&&(t.fontWeight="bold"),null!=e.italic&&e.italic&&(t.fontStyle="italic"),null!=e.strikethrough&&e.strikethrough&&(t.textDecoration="line-through"),null!=e.underline&&e.underline&&(t.textDecoration="underline"),t):t}function g(e){let t,n="";for(;e>0;)t=(e-1)%26,n=String.fromCharCode(t+65)+n,e=(e-t-1)/26;return n}function f(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}function m(e){if(!e)return"";let t=e.effectiveFormat;return null==t||null==t.numberFormat||null==t.numberFormat.pattern?"":t.numberFormat.pattern.startsWith('"$"')?p.currencyInput:"PERCENT"==t.numberFormat.type?p.percentInput:""}const p={error:"gtable-error",table:"gtable",thead:"gtable-head",th:"gtable-column-head",tbody:"gtable-body",tr:"gtable-row",td:"gtable-cell",input:"gtable-input",dirtyInput:"gtable-unsaved-changes",currencyInput:"gtable-currency",percentInput:"gtable-percentage"};class h{constructor(){this.columnTabbing=!1,this.effects=[],this.configurable=()=>!1,this.submitHandler=()=>{},this.createmaxtrix=!1}}const b=l.createContext(p),x=l.createContext(new class{constructor(){this.settings=new h,this.numrows=0,this.numcols=0,this.rowSizes=[],this.colSizes=[],this.data=[],this.merges=[]}}),w=l.createContext([]);function y(e){const t=l.useContext(b),n=l.useContext(x),r=l.useContext(w);let a=e.data?.effectiveValue?.numberValue||0,o=m(e.data);o==p.currencyInput&&(a=parseFloat(a.toFixed(2))),o==p.percentInput&&(a=parseFloat((100*a).toFixed(6)),e.style.paddingRight="1.01em");let s=function(e,t){let n={...e};return t==p.percentInput&&(n.paddingRight="1.01em"),n.border="none",n.maxHeight="",n.height="",n.width=parseFloat(n.width.replace("px",""))-(parseInt(n.borderLeft,10)||1)+"px",n}(e.style,o),[u]=l.useState(a),[i,c]=l.useState(a.toString()),[d,g]=l.useState("");const f=e=>{e.target.select()};return l.createElement("input",{className:t.input+" "+o+" "+d,style:s,"data-orig":a,value:i,tabIndex:n.settings.columnTabbing?e.col:e.row,onChange:n=>{let a=function(e){let t=(e=e.replace(/[^0-9\-\.]+/g,"")).split(".");return t.length>2&&(e=t[0]+"."+t.slice(1).join("")),e.replace(/(?!^)\-/g,"")}(n.target.value),l=a?parseFloat(a):0;l!=u?(g(t.dirtyInput),o==t.percentInput&&(l/=100),function(e,t,n){e.push({range:t,values:[[n]]})}(r,e.address,l)):(g(""),function(e,t){for(let n=0;n<e.length;n++)e[n]?.range==t&&e.splice(n,1)}(r,e.address)),c(a)},onFocus:f,onClick:f,onKeyDown:e=>{"Enter"===e.key&&n.settings.submitHandler(r)}})}function C(e){const t=l.useContext(b);if("error"in e.data)return l.createElement("table",{className:t.table+" "+t.error});let n=e.data,r=n.sheets?.[0]?.data?.[0]?.rowData||[],a=n.sheets?.[0]?.data?.[0]?.rowMetadata||[],o=n.sheets?.[0]?.data?.[0]?.columnMetadata||[],s=n.sheets?.[0]?.merges||[],u=e.settings||new h,c=n.numrows,d=n.numcols;c&&d||({numrows:c,numcols:d}=i(r));const g={settings:u,numrows:c,numcols:d,rowSizes:a,colSizes:o,data:r,merges:s};for(let e=0;e<u.effects.length;e++)l.useEffect(u.effects[e]);return l.createElement(x.Provider,{value:g},l.createElement("table",{className:t.table},l.createElement(S,null),l.createElement(E,null)))}function S(){const e=l.useContext(b),t=l.useContext(x),n=[];for(let a=0;a<t.numcols;a++){let o=(r=t.colSizes[a],{width:`${r?.pixelSize||0}px`});n.push(l.createElement("th",{className:e.th,style:o,key:a},g(a+1)))}var r;return l.createElement("thead",{className:e.thead},l.createElement("tr",null,n))}function E(){const e=l.useContext(b),t=l.useContext(x),n=[];for(let e=0;e<t.numrows;e++)t.data[e]&&n.push(l.createElement(v,{row:e,key:e}));return l.createElement("tbody",{className:e.tbody,onKeyDown:e=>{"Enter"===e.key&&t.settings.submitHandler()}},n)}function v(e){const t=l.useContext(b),n=l.useContext(x),r=[];for(let t=0;t<n.numcols;t++)r.push(l.createElement(I,{row:e.row,col:t,key:t}));let a=(o=n.rowSizes[e.row],{height:`${o?.pixelSize||0}px`});var o;return l.createElement("tr",{className:t.tr,style:a},r)}function I(e){const t=l.useContext(b),n=l.useContext(x);let r,{row:a,col:s}=e,i=n.data[a]?.values?.[s],p=n.rowSizes[a],h=n.colSizes[s],w={},C={},S=t.td,E=function(e,t,n){let r=new u,a=e.filter((e=>e.startRowIndex==t&&e.startColumnIndex==n));return r.startOfMerge=a.length>0,r.startOfMerge?(r.context={...a[0]},r):(a=e.filter((e=>(e.startRowIndex||0)<=t&&(e.endRowIndex||0)>t&&(e.startColumnIndex||0)<=n&&(e.endColumnIndex||0)>n)),r.inMerge=a.length>0,r.inMerge&&(r.context={...a[0]}),r)}(n.merges,a,s);if(E.inMerge&&!E.startOfMerge)return null;if(w=function(e,t,n){let r={},a=e?.effectiveFormat;if(!a)return r;null!=a.backgroundColorStyle?.rgbColor?r.backgroundColor=c(a.backgroundColorStyle.rgbColor):null!=a.backgroundColor&&(r.backgroundColor=c(a.backgroundColor));let l=a.horizontalAlignment;null!=l&&(r.textAlign=l);let o=a.verticalAlignment;null!=o&&(r.verticalAlign=o);let s=a.padding;if(null!=s)for(const e of Object.entries(s))r[`padding${f(e[0])}`]=`${e[1]||0}px`;let u=a.borders;if(u)for(const e of Object.entries(u)){let t=e[1];if(t&&null!=t.colorStyle?.rgbColor){let n=`${t.width||0}px ${t.style||"solid"} ${c(t.colorStyle.rgbColor)}`;r[`border${f(e[0])}`]=n}}let i=a.textFormat;if(null!=i&&Object.assign(r,d(i)),null!=a.wrapStrategy&&("OVERFLOW_CELL"==a.wrapStrategy&&(r.overflow="visible",r.whiteSpace="pre"),"CLIP"==a.wrapStrategy&&(r.overflow="hidden",r.whiteSpace="pre"),"WRAP"==a.wrapStrategy&&(r.whiteSpace="pre-wrap")),t){let e=t.pixelSize||0;r.maxHeight=`${e}px`,r.height=`${e}px`}if(n){let e=n.pixelSize||0;r.maxWidth=`${e}px`,r.width=`${e}px`}return r}(i,p,h),E.startOfMerge){let e=E.context;C.colSpan=(e.endColumnIndex||0)-(e.startColumnIndex||0),C.rowSpan=(e.endRowIndex||0)-(e.startRowIndex||0)}return C["data-range"]=g(s+1)+(a+1),C["data-col"]=s,C["data-row"]=a,n.settings.configurable(i)?(r=l.createElement(y,{data:i,style:{...w},row:a,col:s,address:C["data-range"]}),S+=" "+m(i),w.padding="0",w.backgroundColor="red"):r=l.createElement(F,{data:i}),i?.note&&(C.title=i.note,C["data-toggle"]="tooltip"),l.createElement("td",o({className:S,style:w},C),r)}function F(e){if(e.data){if(null==e.data.textFormatRuns)return l.createElement(l.Fragment,null,e.data.formattedValue);{let t=[],n=e.data.textFormatRuns.length-1;for(let r=0;r<=n;r++){let a=e.data.textFormatRuns[r]?.format,o=e.data.formattedValue||"",s=0==r?0:e.data.textFormatRuns[r]?.startIndex||0,u=r==n?o.length:e.data.textFormatRuns[r+1]?.startIndex||0;o=o.slice(s,u);let i,c=d(a),g=0;i=a?.link?.uri?l.createElement("a",{href:a.link.uri,target:"_blank",key:g},o):l.createElement("span",{key:g},o);let f=l.createElement("span",{style:c,key:r},i);t.push(f)}return l.createElement(l.Fragment,null,t)}}return l.createElement(l.Fragment,null)}e.GTable=C,e.GTableClasses=p,e.GTableInputData=class{constructor(){this.range="",this.values=[[]]}},e.GTableSettings=h,e.columnToLetter=g,e.letterToColumn=function(e){let t=0,n=e.length;for(let r=0;r<n;r++)t+=(e.charCodeAt(r)-64)*Math.pow(26,n-r-1);return t},e.renderGTable=function(e,t,n){e=e.replace("#","");const r=a(document.getElementById(e));if("error"in t)return r;if(n?.createmaxtrix){let{numrows:e,numcols:n}=i(t.sheets?.[0]?.data?.[0]?.rowData||[]);t.numrows=e,t.numcols=n,function(e){for(let t=0;t<e.numrows;t++){e.data[t]=[];for(let n=0;n<e.numcols;n++){let r=e.sheets?.[0]?.data?.[0]?.rowData?.[t]?.values?.[n];r?e.data[t]?.push(r):e.data[t]?.push(null)}}}(t)}return r.render(l.createElement(C,{data:t,settings:n})),r}}));
